<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Table</title>

    <!--================= Remix Icon =================-->
    <link
        rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/4.1.0/remixicon.css"/>

    <link rel="stylesheet" href="../Assets/css/styles.css">
</head>
<body>
    <section class="sidebar">
        <div class="sidebar-top">
            <a href="" class="sidebar-title">Brew & Bounty</a>
            <img src="../Assets/coffee-beans.png" alt="Logo Icon">
        </div>
        
        <hr class="line">

        <ul class="sidebar-content">
            <a href=""><li><i class="ri-home-2-line"></i>Home</li></a>
            <li id="menu"><i class="ri-restaurant-2-line"></i>Menu</li>
                <a href="food.html" class="menu-dropdown"><li><i class="ri-bowl-fill"></i>Foods</li></a>
                <a href="" class="menu-dropdown"><li><i class="ri-cup-line"></i>Drinks</li></a>
            <a href="cashiers.html"><li><i class="ri-admin-line"></i>Cashiers</li></a>
        </ul>
    </section>

    <section class="main-content">
        <div class="top">
            <a href="" class="top-title">Brew & Bounty > <b>Menu</b></a>
            <a href="../addMenu.html" class="add-button">Add Items</a>
        </div>

        <h1 class="main-title">Items</h1>

        <div class="table">
            <div class="table-option">
                <label for="filter" id="filter-label"><i class="ri-filter-3-line"></i>Filter</label>
                <select name="filter" id="filter" hidden>
                    <option value="ascending">Ascending</option>
                    <option value="descending">Descending</option>
                    <option value="orderDate">Order Date</option>
                </select>
                <div id="custom-dropdown" class="custom-dropdown">
                    <div class="option" data-value="ascending">Ascending</div>
                    <div class="option" data-value="descending">Descending</div>
                    <div class="option" data-value="orderDate">Order Date</div>
                </div>    
            </div>

            <div class="table-content" id="table-content">
                <table>
                    <thead>
                        <tr>
                            <th>Menu Image</th>
                            <th>Food Menu</th>
                            <th>Menu ID</th>
                            <th>Price</th>
                            <th>Description</th>
                            <th>Action</th>
                        </tr>
                    </thead>

                    <tbody id="table-body">
                        <!-- <tr>
                            <td><img src="" alt="Pizza Photo"></td>
                            <td>Pizza</td>
                            <td>1</td>
                            <td>$1.50</td>
                            <td>Italian food that served with topping like pepperoni, parsley and cheese with sauce</td>
                        </tr> -->
                    </tbody>
                </table>

                <form class="pagination">
                    <label for="dataperpage">Lines per Page</label>
                    <select name="dataperpage" id="dataperpage">
                        <option value="5">5</option>
                        <option value="10">10</option>
                        <option value="15">15</option>
                        <option value="20">20</option>
                    </select>
                    <p>1 - 5 out of ??</p>
                    <div class="pagination-button">
                        <a href=""><i class="ri-arrow-left-s-line"></i></a>
                        <a href=""><i class="ri-arrow-right-s-line"></i></a>
                    </div>
                </form>
            </div>
        </div>
    </section>

    <script src="../Assets/js/script.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-database.js"></script>
    <script type="module">
    // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
        import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-database.js";
        
    // Your web app's Firebase configuration
        const firebaseConfig = {
          apiKey: "AIzaSyDzURQckDxjVYzWHcRSfq0VTBjqwQYhUg0",
          authDomain: "brew-bounty-admin.firebaseapp.com",
          databaseURL: "https://brew-bounty-admin-default-rtdb.asia-southeast1.firebasedatabase.app",
          projectId: "brew-bounty-admin",
          storageBucket: "brew-bounty-admin.appspot.com",
          messagingSenderId: "108525876940",
          appId: "1:108525876940:web:e8eff02f81f9425d65f469",
          measurementId: "G-124F208GM2"
        };
  
    // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);
        const menuRef = ref(database, 'menu');

        function fetchandDisplayMenu () {
            onValue (menuRef, (snapshot) => {
                const data = snapshot.val();
                const tableBody = document.getElementById('table-body');

                // Pembersihan tabel sebelum data baru 
                tableBody.innerHTML = '';

                // Iterasi melalui data dan ditambahkan ke tabel
                for (const key in data) {
                    if (data.hasOwnProperty(key)) {

                        const menuItem = data[key];
                        const row = document.createElement('tr');

                        const menuImage = document.createElement('td');
                        const img = document.createElement('img');
                        img.src = menuItem.imageURL;
                        img.alt = `${menuItem.name} Photo`;
                        img.className = 'table-img';
                        img.oneerror = () => {
                            console.error(`Gagal memuat gambar dari URL: ${menuItem.imageURL}`);
                        };
                        menuImage.appendChild(img);

                        const menuName = document.createElement('td');
                        menuName.textContent = menuItem.name;

                        const menuId = document.createElement('td');
                        menuId.textContent = menuItem.id;

                        const menuPrice = document.createElement('td');
                        const price = parseInt(menuItem.price);
                        menuPrice.textContent = `Rp${price.toFixed(2)}`;

                        const menuDescription = document.createElement('td');
                        menuDescription.textContent = menuItem.description;

                        row.appendChild(menuImage);
                        row.appendChild(menuName);
                        row.appendChild(menuId);
                        row.appendChild(menuPrice);
                        row.appendChild(menuDescription);

                        tableBody.appendChild(row);
                        console.log(menuItem.imageURL);
                    }
                }
            });
        }

        document.addEventListener('DOMContentLoaded', fetchandDisplayMenu);
        console.log
    </script>
</body>
</html>